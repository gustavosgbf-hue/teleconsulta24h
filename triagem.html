<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Triagem M√©dica ¬∑ Pronto Atendimento Online</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;0,700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;min-height:100vh}
body{font-family:'Outfit',sans-serif;background:#060d0b;color:rgba(255,255,255,.92);-webkit-font-smoothing:antialiased;overflow-x:hidden}

:root{
  --g1:#b4e05a;--g2:#5ee0a0;
  --line:rgba(255,255,255,.09);
  --card:rgba(255,255,255,.045);
  --muted:rgba(255,255,255,.55);
}

.bg-glow{position:fixed;inset:0;z-index:0;pointer-events:none;
  background:radial-gradient(ellipse 70vw 60vh at 10% 0%,rgba(180,224,90,.12) 0%,transparent 60%),
  radial-gradient(ellipse 50vw 40vh at 90% 10%,rgba(94,224,160,.09) 0%,transparent 55%);}

.nav{position:sticky;top:0;z-index:100;background:rgba(6,13,11,.85);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-bottom:1px solid var(--line)}
.nav__in{display:flex;align-items:center;justify-content:space-between;padding:13px 20px;gap:12px}
.nav__brand{display:flex;align-items:center;gap:8px;font-weight:600;font-size:.88rem}
.live-dot{width:7px;height:7px;border-radius:50%;background:var(--g2);animation:pulse 2s ease-in-out infinite;flex-shrink:0}
@keyframes pulse{0%,100%{opacity:1;box-shadow:0 0 0 0 rgba(94,224,160,.5)}50%{opacity:.8;box-shadow:0 0 0 5px rgba(94,224,160,0)}}
.nav__step{font-size:.72rem;font-weight:500;letter-spacing:.08em;text-transform:uppercase;color:rgba(255,255,255,.45)}

.screen{display:none;min-height:calc(100vh - 52px);position:relative;z-index:1}
.screen.active{display:flex;flex-direction:column}

/* TERMOS */
#screen-terms{align-items:center;justify-content:center;padding:24px}
.terms-box{width:min(580px,100%);border:1px solid var(--line);border-radius:22px;background:rgba(255,255,255,.03);overflow:hidden}
.terms-head{padding:22px 24px 18px;border-bottom:1px solid var(--line)}
.terms-head h1{font-family:'Playfair Display',serif;font-size:1.35rem;font-weight:500;margin-bottom:5px}
.terms-head p{font-size:.78rem;color:var(--muted);font-weight:300}
.terms-body{padding:20px 24px;display:flex;flex-direction:column;gap:10px}
.titem{font-size:.82rem;font-weight:300;color:rgba(255,255,255,.6);line-height:1.7;padding-left:12px;border-left:2px solid rgba(180,224,90,.3)}
.titem strong{color:rgba(255,255,255,.85);font-weight:500;display:block;margin-bottom:2px}
.terms-foot{padding:18px 24px 24px;border-top:1px solid var(--line);background:rgba(0,0,0,.2)}
.check-row{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px;cursor:pointer}
.check-row input[type=checkbox]{width:18px;height:18px;margin-top:2px;accent-color:#b4e05a;flex-shrink:0;cursor:pointer}
.check-row span{font-size:.82rem;color:rgba(255,255,255,.7);line-height:1.55;font-weight:300}
.btn-aceitar{width:100%;padding:14px;border-radius:14px;border:none;background-color:#b4e05a;color:#051208;font-family:'Outfit',sans-serif;font-weight:600;font-size:.95rem;cursor:not-allowed;opacity:.35;display:block;-webkit-appearance:none;appearance:none;box-shadow:0 6px 24px rgba(180,224,90,.2);transition:opacity .2s,box-shadow .2s}
.btn-aceitar.on{opacity:1;cursor:pointer;box-shadow:0 6px 24px rgba(180,224,90,.35)}

/* TRIAGEM CHAT */
#screen-triage{flex-direction:column}
.progress-bar{height:3px;background:rgba(255,255,255,.06);flex-shrink:0}
.progress-fill{height:100%;background:linear-gradient(90deg,#b4e05a,#5ee0a0);transition:width .5s ease;width:0%}
.chat-area{flex:1;overflow-y:auto;padding:20px;display:flex;flex-direction:column;gap:14px;scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.1) transparent}
.chat-area::-webkit-scrollbar{width:3px}
.chat-area::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);border-radius:3px}
.msg{display:flex;gap:10px;align-items:flex-end;animation:msgIn .25s ease}
@keyframes msgIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
.msg--bot{align-self:flex-start;max-width:85%}
.msg--user{align-self:flex-end;flex-direction:row-reverse;max-width:85%}
.msg__av{width:30px;height:30px;border-radius:50%;background:rgba(255,255,255,.06);border:1px solid var(--line);display:flex;align-items:center;justify-content:center;font-size:.8rem;flex-shrink:0}
.msg__bubble{padding:11px 15px;border-radius:16px;font-size:.875rem;font-weight:300;line-height:1.65}
.msg--bot .msg__bubble{background:rgba(255,255,255,.06);border:1px solid var(--line);border-bottom-left-radius:4px;color:rgba(255,255,255,.88)}
.msg--user .msg__bubble{background-color:#b4e05a;background-image:linear-gradient(135deg,#b4e05a,#6ed49a);color:#051208;font-weight:500;border-bottom-right-radius:4px}
.typing{display:flex;gap:4px;padding:11px 15px;align-items:center}
.typing span{width:6px;height:6px;border-radius:50%;background:rgba(255,255,255,.4);animation:typDot 1.2s ease-in-out infinite}
.typing span:nth-child(2){animation-delay:.2s}
.typing span:nth-child(3){animation-delay:.4s}
@keyframes typDot{0%,80%,100%{transform:translateY(0);opacity:.4}40%{transform:translateY(-5px);opacity:1}}
.quick-replies{display:flex;flex-wrap:wrap;gap:8px;padding:0 20px 12px}
.qr{padding:8px 16px;border-radius:999px;border:1px solid rgba(180,224,90,.3);background:rgba(180,224,90,.06);color:var(--g1);font-family:'Outfit',sans-serif;font-size:.8rem;font-weight:500;cursor:pointer;transition:background .15s;-webkit-appearance:none;appearance:none}
.qr:hover{background:rgba(180,224,90,.14)}
.input-bar{padding:12px 16px 20px;border-top:1px solid var(--line);background:rgba(6,13,11,.9);display:flex;gap:10px;align-items:flex-end;flex-shrink:0}
.input-bar textarea{flex:1;padding:10px 14px;border-radius:13px;background:rgba(255,255,255,.07);border:1px solid var(--line);color:#fff;font-family:'Outfit',sans-serif;font-size:.875rem;font-weight:300;resize:none;outline:none;min-height:42px;max-height:110px;line-height:1.5;transition:border-color .2s;-webkit-appearance:none}
.input-bar textarea::placeholder{color:rgba(255,255,255,.28)}
.input-bar textarea:focus{border-color:rgba(94,224,160,.35)}
.send-btn{width:42px;height:42px;border-radius:50%;border:none;background-color:#b4e05a;background-image:linear-gradient(135deg,#b4e05a,#5ee0a0);color:#051208;cursor:pointer;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:transform .12s;box-shadow:0 4px 14px rgba(180,224,90,.28);-webkit-appearance:none;appearance:none}
.send-btn:hover{transform:scale(1.08)}
.send-btn[disabled]{opacity:.4;cursor:not-allowed;transform:none}

/* SCREEN WHATSAPP */
#screen-whats{align-items:center;justify-content:center;padding:24px}
.wa-box{width:min(480px,100%);border:1px solid var(--line);border-radius:22px;background:rgba(255,255,255,.03);overflow:hidden}
.wa-head{padding:22px 24px 18px;border-bottom:1px solid var(--line);display:flex;align-items:center;gap:14px}
.wa-icon{width:44px;height:44px;border-radius:50%;background:#25D366;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.wa-head-text h2{font-family:'Playfair Display',serif;font-size:1.2rem;font-weight:500;margin-bottom:3px}
.wa-head-text p{font-size:.78rem;color:var(--muted);font-weight:300}
.wa-body{padding:20px 24px}
.wa-summary{background:rgba(180,224,90,.06);border:1px solid rgba(180,224,90,.2);border-radius:14px;padding:14px 16px;margin-bottom:20px;font-size:.8rem;font-weight:300;color:rgba(255,255,255,.7);line-height:1.7;max-height:140px;overflow-y:auto}
.wa-label{font-size:.72rem;font-weight:500;letter-spacing:.08em;text-transform:uppercase;color:rgba(255,255,255,.45);margin-bottom:8px}
.wa-input{width:100%;padding:12px 16px;border-radius:13px;background:rgba(255,255,255,.07);border:1px solid var(--line);color:#fff;font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:300;outline:none;transition:border-color .2s;-webkit-appearance:none;margin-bottom:16px}
.wa-input::placeholder{color:rgba(255,255,255,.28)}
.wa-input:focus{border-color:rgba(94,224,160,.35)}
.wa-options{display:flex;gap:10px;margin-bottom:20px}
.wa-opt{flex:1;padding:12px;border-radius:13px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:rgba(255,255,255,.7);font-family:'Outfit',sans-serif;font-size:.82rem;font-weight:400;cursor:pointer;text-align:center;transition:all .15s;-webkit-appearance:none}
.wa-opt.selected,.wa-opt:hover{border-color:rgba(37,211,102,.4);background:rgba(37,211,102,.08);color:#fff}
.wa-send{width:100%;padding:14px;border-radius:14px;border:none;background:#25D366;color:#fff;font-family:'Outfit',sans-serif;font-weight:600;font-size:.95rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;-webkit-appearance:none;box-shadow:0 6px 24px rgba(37,211,102,.28);transition:transform .12s,box-shadow .2s}
.wa-send:hover{transform:translateY(-1px);box-shadow:0 10px 28px rgba(37,211,102,.38)}
</style>
</head>
<body>

<div class="bg-glow" aria-hidden="true"></div>

<nav class="nav">
  <div class="nav__in">
    <div class="nav__brand"><div class="live-dot"></div>Pronto Atendimento Online</div>
    <span class="nav__step" id="nav-step">TERMOS DE USO</span>
  </div>
</nav>

<!-- SCREEN 1: TERMOS -->
<div id="screen-terms" class="screen active">
  <div class="terms-box">
    <div class="terms-head">
      <h1>Termos de Uso e TCLE</h1>
      <p>Leia os pontos principais antes de iniciar sua triagem.</p>
    </div>
    <div class="terms-body">
      <div class="titem"><strong>Servi√ßo</strong>Orienta√ß√£o m√©dica remota por chat, conforme CFM 2.314/2022. N√£o substitui emerg√™ncia presencial.</div>
      <div class="titem"><strong>Tempo de resposta</strong>Pode levar at√© 12 horas. Se for emerg√™ncia, v√° ao pronto-socorro agora.</div>
      <div class="titem"><strong>Documentos</strong>Atestados e receitas s√≥ s√£o emitidos quando h√° indica√ß√£o cl√≠nica. N√£o √© autom√°tico.</div>
      <div class="titem"><strong>Privacidade</strong>Seus dados de sa√∫de s√£o tratados com sigilo, conforme a LGPD.</div>
      <div class="titem"><strong>Veracidade</strong>Voc√™ se compromete a fornecer informa√ß√µes verdadeiras.</div>
    </div>
    <div class="terms-foot">
      <label class="check-row" for="termsCheck">
        <input type="checkbox" id="termsCheck"/>
        <span>Li e concordo com os Termos de Uso, Pol√≠tica de Privacidade e TCLE para teleatendimento.</span>
      </label>
      <button class="btn-aceitar" id="btnAceitar">Aceitar e iniciar triagem</button>
    </div>
  </div>
</div>

<!-- SCREEN 2: TRIAGEM -->
<div id="screen-triage" class="screen">
  <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
  <div class="chat-area" id="triageChat"></div>
  <div class="quick-replies" id="quickReplies"></div>
  <div class="input-bar">
    <textarea id="triageInput" placeholder="Digite sua resposta..." rows="1"></textarea>
    <button class="send-btn" id="triageSend" aria-label="Enviar">
      <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
    </button>
  </div>
</div>

<!-- SCREEN 3: WHATSAPP -->
<div id="screen-whats" class="screen">
  <div class="wa-box">
    <div class="wa-head">
      <div class="wa-icon">
        <svg viewBox="0 0 32 32" fill="white" width="24" height="24"><path d="M16 3C9.4 3 4 8.2 4 14.7c0 2.6.8 5 2.3 7.1L4 29l7.4-2.3c2 .9 4.2 1.3 6.6 1.3 6.6 0 12-5.2 12-11.7S22.6 3 16 3zm6.8 16.6c-.3.8-1.8 1.6-2.5 1.7-.6.1-1.3.2-2.1-.1-.5-.2-1.2-.4-2.1-.8-3.7-1.6-6.1-5.4-6.3-5.6-.2-.3-1.5-2-.1-3.8.3-.4.7-.6 1-.6h.7c.2 0 .5 0 .7.5.3.7 1 2.3 1.1 2.4.1.1.1.4 0 .6-.1.2-.2.4-.4.6-.2.2-.3.4-.5.6-.2.2-.3.4-.1.7.2.3 1 1.6 2.2 2.6 1.5 1.3 2.7 1.7 3 1.9.3.2.5.1.7-.1.2-.2.8-.9 1-1.2.2-.3.4-.2.7-.1.3.1 1.8.8 2.1.9.3.2.5.3.6.5.1.2.1 1.2-.2 2z"/></svg>
      </div>
      <div class="wa-head-text">
        <h2>Quase pronto!</h2>
        <p>Informe seu WhatsApp para continuar o atendimento.</p>
      </div>
    </div>
    <div class="wa-body">
      <div class="wa-label">Resumo da triagem</div>
      <div class="wa-summary" id="waSummary"></div>
      <div class="wa-label">Seu WhatsApp com DDD</div>
      <input class="wa-input" id="waPhone" type="tel" placeholder="Ex: 98912345678" inputmode="numeric"/>
      <div class="wa-label">Como prefere ser atendido?</div>
      <div class="wa-options">
        <button class="wa-opt selected" id="optMsg" onclick="selectOpt('msg')">üí¨ Por mensagem</button>
        <button class="wa-opt" id="optVid" onclick="selectOpt('vid')">üìπ Videoconfer√™ncia</button>
      </div>
      <button class="wa-send" onclick="enviarWhats()">
        <svg viewBox="0 0 32 32" fill="white" width="20" height="20"><path d="M16 3C9.4 3 4 8.2 4 14.7c0 2.6.8 5 2.3 7.1L4 29l7.4-2.3c2 .9 4.2 1.3 6.6 1.3 6.6 0 12-5.2 12-11.7S22.6 3 16 3zm6.8 16.6c-.3.8-1.8 1.6-2.5 1.7-.6.1-1.3.2-2.1-.1-.5-.2-1.2-.4-2.1-.8-3.7-1.6-6.1-5.4-6.3-5.6-.2-.3-1.5-2-.1-3.8.3-.4.7-.6 1-.6h.7c.2 0 .5 0 .7.5.3.7 1 2.3 1.1 2.4.1.1.1.4 0 .6-.1.2-.2.4-.4.6-.2.2-.3.4-.5.6-.2.2-.3.4-.1.7.2.3 1 1.6 2.2 2.6 1.5 1.3 2.7 1.7 3 1.9.3.2.5.1.7-.1.2-.2.8-.9 1-1.2.2-.3.4-.2.7-.1.3.1 1.8.8 2.1.9.3.2.5.3.6.5.1.2.1 1.2-.2 2z"/></svg>
        Iniciar atendimento no WhatsApp
      </button>
    </div>
  </div>
</div>

<script>
var SEU_WHATS = '5598989272727'; // seu n√∫mero

/* TERMOS */
var chk = document.getElementById('termsCheck');
var btn = document.getElementById('btnAceitar');
chk.addEventListener('change', function(){ btn.classList.toggle('on', chk.checked); });
btn.addEventListener('click', function(){
  if(!chk.checked) return;
  showScreen('triage');
  document.getElementById('nav-step').textContent = 'TRIAGEM M√âDICA';
  startTriage();
});

/* SCREENS */
function showScreen(name){
  document.querySelectorAll('.screen').forEach(function(s){ s.classList.remove('active'); });
  document.getElementById('screen-'+name).classList.add('active');
}

/* STATE */
var triageHistory = [];
var anamnesis = {};
var step = 0;
var pending = false;
var modalidade = 'msg';

var SYSTEM_TRIAGE = 'Voc√™ √© um assistente de triagem m√©dica de um servi√ßo de telemedicina chamado "Pronto Atendimento Online". Conduza uma anamnese inicial estruturada em portugu√™s brasileiro, de forma emp√°tica, clara e objetiva.\n\nSiga esta ordem obrigat√≥ria:\n1. Pe√ßa o nome completo do paciente\n2. Pergunte idade e sexo\n3. Pergunte a queixa principal\n4. Pergunte h√° quanto tempo tem o sintoma e intensidade (0-10)\n5. Fa√ßa perguntas cl√≠nicas relevantes: febre, outros sintomas associados, fatores de melhora/piora\n6. Pergunte sobre doen√ßas cr√¥nicas, alergias e medicamentos em uso\n7. Pergunte se precisa de atestado ou receita\n\nIMPORTANTE:\n- Fa√ßa UMA pergunta por vez\n- Seja breve e direto\n- Use linguagem acess√≠vel\n- Quando tiver coletado todos os dados, responda APENAS com JSON: {"done":true,"summary":"[anamnese formatada]"}\n- Se identificar sinais de emerg√™ncia (dor no peito intensa, falta de ar grave, desmaio), oriente ir ao pronto-socorro imediatamente';

/* TRIAGE */
function startTriage(){
  addMsg('triageChat','bot','Ol√°! Sou o assistente de triagem do Pronto Atendimento Online. Vou fazer algumas perguntas r√°pidas para preparar seu atendimento m√©dico.\n\nPodemos come√ßar? Qual √© o seu nome completo?');
  step=1; updateProgress(1);
}

function addMsg(chatId, type, text){
  var chat = document.getElementById(chatId);
  var div = document.createElement('div');
  div.className = 'msg msg--'+type;
  var botAv = '<div class="msg__av">&#x1F3E5;</div>';
  var userAv = '<div class="msg__av">&#x1F464;</div>';
  var safe = String(text||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');
  var bubble = '<div class="msg__bubble">'+safe+'</div>';
  div.innerHTML = type==='bot' ? botAv+bubble : bubble+userAv;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function showTyping(chatId){
  var chat = document.getElementById(chatId);
  var div = document.createElement('div');
  div.className='msg msg--bot'; div.id=chatId+'-typing';
  div.innerHTML='<div class="msg__av">&#x1F3E5;</div><div class="msg__bubble"><div class="typing"><span></span><span></span><span></span></div></div>';
  chat.appendChild(div); chat.scrollTop=chat.scrollHeight;
}
function removeTyping(chatId){ var el=document.getElementById(chatId+'-typing'); if(el) el.remove(); }
function updateProgress(s){ document.getElementById('progressFill').style.width=Math.min(Math.round((s/12)*100),100)+'%'; }

function setQuickReplies(opts){
  var box=document.getElementById('quickReplies'); box.innerHTML='';
  if(!opts||!opts.length) return;
  opts.forEach(function(o){
    var b=document.createElement('button'); b.className='qr'; b.textContent=o;
    b.onclick=function(){ sendTriage(o); box.innerHTML=''; };
    box.appendChild(b);
  });
}

async function sendTriage(text){
  if(!text||pending) return;
  pending=true; document.getElementById('triageSend').disabled=true;
  addMsg('triageChat','user',text);
  document.getElementById('triageInput').value='';
  document.getElementById('triageInput').style.height='auto';
  setQuickReplies([]);
  step++; updateProgress(step);
  showTyping('triageChat');
  var reply = await callAPI('/api/triage', SYSTEM_TRIAGE, triageHistory, text);
  removeTyping('triageChat');

  try {
    var clean = String(reply).replace(/```json|```/g,'').trim();
    var parsed = JSON.parse(clean);
    if(parsed.done && parsed.summary){
      anamnesis.summary = parsed.summary;
      updateProgress(12);
      setTimeout(function(){ goToWhats(); }, 600);
      pending=false; document.getElementById('triageSend').disabled=false;
      return;
    }
  } catch(e){}

  addMsg('triageChat','bot',reply);
  if(step===3) setQuickReplies(['Masculino','Feminino','Prefiro n√£o dizer']);
  if(step===5) setQuickReplies(['1-3','4-6','7-8','9-10']);
  if(step===7) setQuickReplies(['Sim, tenho febre','N√£o tenho febre']);
  if(step===9) setQuickReplies(['Sim','N√£o']);
  if(step===10) setQuickReplies(['Apenas atestado','Apenas receita','Ambos','Nenhum']);
  pending=false; document.getElementById('triageSend').disabled=false;
}

/* WHATSAPP SCREEN */
function goToWhats(){
  showScreen('whats');
  document.getElementById('nav-step').textContent = 'FINALIZAR';
  document.getElementById('waSummary').textContent = anamnesis.summary || '';
}

function selectOpt(opt){
  modalidade = opt;
  document.getElementById('optMsg').classList.toggle('selected', opt==='msg');
  document.getElementById('optVid').classList.toggle('selected', opt==='vid');
}

function enviarWhats(){
  var phone = document.getElementById('waPhone').value.replace(/\D/g,'');
  if(!phone || phone.length < 10){
    document.getElementById('waPhone').focus();
    document.getElementById('waPhone').style.borderColor='rgba(255,100,100,.5)';
    return;
  }
  document.getElementById('waPhone').style.borderColor='';

  var mod = modalidade==='vid' ? 'Videoconfer√™ncia' : 'Mensagem (chat)';
  var msg = 'üè• *Triagem conclu√≠da ‚Äî Pronto Atendimento Online*\n\n'
    + '*Modalidade preferida:* ' + mod + '\n'
    + '*WhatsApp do paciente:* ' + phone + '\n\n'
    + '*Anamnese:*\n' + (anamnesis.summary || '') + '\n\n'
    + '_(Mensagem gerada automaticamente pela triagem online)_';

  window.open('https://wa.me/'+SEU_WHATS+'?text='+encodeURIComponent(msg), '_blank');
}

/* API */
async function callAPI(endpoint, system, history, userMsg){
  history.push({role:'user', content:userMsg});
  try {
    var res = await fetch('https://triagem-api.onrender.com'+endpoint, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({system:system, messages:history})
    });
    var data = await res.json();
    var text = data.text || (data.content&&data.content[0]&&data.content[0].text) || '';
    history.push({role:'assistant', content:text});
    return text;
  } catch(e){ history.pop(); return 'Erro de conex√£o. Verifique sua internet e tente novamente.'; }
}

/* INPUT HANDLERS */
var triageInput = document.getElementById('triageInput');
triageInput.addEventListener('input', function(){ this.style.height='auto'; this.style.height=Math.min(this.scrollHeight,110)+'px'; });
triageInput.addEventListener('keydown', function(e){ if(e.key==='Enter'&&!e.shiftKey){ e.preventDefault(); sendTriage(this.value.trim()); } });
document.getElementById('triageSend').addEventListener('click', function(){ sendTriage(triageInput.value.trim()); });
</script>
</body>
</html>
